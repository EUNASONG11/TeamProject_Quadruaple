import{p as $,r as a,y as q,R as T,g as O,j as e,u as F}from"./index-DIxnD1JS.js";import{d as S,a as W,b as _,m as G,c as Z,e as J,F as Q}from"./match-QaCd9MGg.js";import{I as U}from"./TitleHeader-serYiGmW.js";import{G as L}from"./iconBase-CW5Yvc9x.js";import"./jwt-DMf2LOVp.js";import{t as P}from"./tripAtom-Ba2n1jmb.js";import{a as H}from"./axios-upsvKRUO.js";import{I as X}from"./index-BJd-TzMh.js";import{B as Y}from"./button-COK4q_fH.js";import{a as ee}from"./pic-Bp3CpqNF.js";import{a as te}from"./index-Cn6zzcDW.js";import{K as se,u as V,a as z,b as I,M as le}from"./MarkerClusterer-DKXz1UtC.js";import{R as ne}from"./index-BQnDhNY2.js";function we(s){return L({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"},child:[]}]})(s)}function Me(s){return L({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M18 20H4V6h9V4H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-9h-2v9zm-7.79-3.17-1.96-2.36L5.5 18h11l-3.54-4.71zM20 4V1h-2v3h-3c.01.01 0 2 0 2h3v2.99c.01.01 2 0 2 0V6h3V4h-3z"},child:[]}]})(s)}function ae(s){return L({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M14 2H4c-1.1 0-2 .9-2 2v10h2V4h10V2zm4 4H8c-1.1 0-2 .9-2 2v10h2V8h10V6zm2 4h-8c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm0 10h-8v-8h8v8z"},child:[]}]})(s)}const oe=$.forwardRef(function(N,x){let{position:p,children:m,clickable:f,xAnchor:w,yAnchor:g,zIndex:j,onCreate:d}=N;const i=a.useContext(se),u=V("CustomOverlayMap"),h=a.useMemo(()=>new kakao.maps.LatLng(p.lat,p.lng),[p.lat,p.lng]),n=a.useMemo(()=>{const v=document.createElement("div");return v.style.display="none",new kakao.maps.CustomOverlay({clickable:f,xAnchor:w,yAnchor:g,zIndex:j,position:h,content:v})},[f,w,g]),r=a.useMemo(()=>n.getContent(),[n]);return a.useImperativeHandle(x,()=>n,[n]),a.useLayoutEffect(()=>{if(u)return i?i.addMarker(n,!0):n.setMap(u),()=>{i?i.removeMarker(n,!0):n.setMap(null)}},[u,i,n]),a.useLayoutEffect(()=>{d&&d(n)},[n,d]),z(n,"setPosition",h),z(n,"setZIndex",j),r.parentElement&&q.createPortal(m,r.parentElement)}),re=$.forwardRef(function(N,x){let{path:p,endArrow:m,onClick:f,onMousedown:w,onMousemove:g,onMouseout:j,onMouseover:d,onCreate:i,strokeColor:u,strokeOpacity:h,strokeStyle:n,strokeWeight:r,zIndex:v}=N;const y=V("Polyline"),k=a.useMemo(()=>p.every(c=>c instanceof Array)?p.map(c=>c.map(C=>new kakao.maps.LatLng(C.lat,C.lng))):p.map(c=>new kakao.maps.LatLng(c.lat,c.lng)),[p]),l=a.useMemo(()=>new kakao.maps.Polyline({path:k,endArrow:m,strokeColor:u,strokeOpacity:h,strokeStyle:n,strokeWeight:r,zIndex:v}),[]);return a.useImperativeHandle(x,()=>l,[l]),a.useLayoutEffect(()=>(l.setMap(y),()=>l.setMap(null)),[y,l]),a.useLayoutEffect(()=>{i&&i(l)},[l,i]),a.useLayoutEffect(()=>{l.setOptions({endArrow:m,strokeColor:u,strokeOpacity:h,strokeStyle:n,strokeWeight:r})},[l,m,u,h,n,r]),z(l,"setPath",k),z(l,"setZIndex",v),I(l,"mouseover",d),I(l,"mouseout",j),I(l,"mousemove",g),I(l,"mousedown",w),I(l,"click",f),null}),ce=({setMemoModal:s,tripId:N,data:x,getTrip:p,setTripData:m})=>{const[f,w]=T(P),g=O("accessToken"),[j,d]=a.useState(""),i=()=>{s(!1)},u=r=>{r.stopPropagation()},h=r=>{d(r.target.value)},n=async r=>{const v=(x==null?void 0:x.schedules.length)>0?x.schedules[x.schedules.length-1].seq:0,y={trip_id:f.nowTripId,day:x.day,seq:v+1,content:r};console.log("메모 데이터",y);try{(await H.post("/api/memo/post",y,{headers:{Authorization:`Bearer ${g}`}})).data.code==="200 성공"&&p()}catch(k){console.log("메모 추가",k)}};return e.jsx("div",{className:`fixed top-0 left-[50%] translate-x-[-50%] z-10\r
                max-w-3xl w-full mx-auto h-full\r
                flex items-center justify-center\r
                bg-[rgba(0,0,0,0.5)]`,onClick:()=>{i()},children:e.jsxs("div",{className:`bg-white w-[630px] \r
                    rounded-2xl px-[60px] py-[55px]\r
                    flex items-center justify-center`,onClick:u,children:[e.jsx(X,{placeholder:"메모를 입력해주세요.",variant:"borderless",allowClear:!0,onChange:r=>{h(r)}}),e.jsx(Y,{type:"Outline",onClick:()=>{n(j),s(!1)},className:"text-slate-600",children:"확인"})]})})},Ne=({data:s,showMap:N=!0,newTrip:x=!1,startAt:p,tripId:m,getTrip:f,setTripData:w,index:g,date:j})=>{const[d,i]=T(P),u=O("accessToken");a.useEffect(()=>{console.log("trip",d)},[d]);const h=F(),n=()=>{h(`/search/trip?tripId=${m}`),console.log(s)},[r,v]=a.useState(!1);a.useState({lat:35.868475,lng:128.593743}),a.useState();const[y,k]=a.useState(!1);a.useEffect(()=>{},[y]);const l=(s==null?void 0:s.schedules)||[],c=l.filter(t=>t.scheOrMemo==="SCHE"),C=c==null?void 0:c.map((t,o)=>({title:t.strfTitle,latlng:{lat:t.lat,lng:t.lng}})),A=[C.map(t=>t.latlng)],R=t=>{if(!t.length)return{lat:37.5665,lng:126.978};const o=t.filter(M=>M.latlng&&parseFloat(M.latlng.lat)!=null&&M.latlng.lng!=null);if(!o.length)return{lat:37.5665,lng:126.978};const b=o.reduce((M,E)=>(M.lat+=parseFloat(E.latlng.lat),M.lng+=parseFloat(E.latlng.lng),M),{lat:0,lng:0});return{lat:b.lat/o.length,lng:b.lng/o.length}};if(a.useEffect(()=>{const t=document.createElement("script");return t.async=!0,t.src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1227efa5c91b2ace09ab915e643a15c9&autoload=false",t.addEventListener("load",()=>{window.kakao.maps.load(()=>{v(!0)})}),document.head.appendChild(t),()=>{document.head.removeChild(t)}},[]),!r)return e.jsx("div",{children:"지도를 불러오는 중입니다..."});const D=()=>{var b;const t=c[c.length-1],o=((b=l[l.length-1])==null?void 0:b.seq)||0;console.log("lastSche",t),console.log("lastSeq",o),i({...d,lastSeq:o,nowTripId:m,day:s.day,prevScheName:c.length>0?t.strfTitle:"",prevSchelat:c.length>0?t.lat:"",prevSchelng:c.length>0?t.lng:""}),n()},B=async t=>{console.log(t);try{const o=await H.delete(`/api/memo/delete?memoId=${t.scheduleMemoId}`,{headers:{Authorization:`Bearer ${u}`}});console.log(o.data),o.data.code==="200 성공"&&f()}catch(o){console.log(o)}},K=t=>{console.log(t),h(`/contents/index?strfId=${t.strfId}`)};return e.jsxs("div",{className:"flex flex-col gap-[30px]",children:[N?e.jsx("div",{className:"h-[292px] px-[32px]",children:e.jsxs(le,{center:R(C),style:{width:"100%",height:"100%",borderRadius:"8px"},level:8,children:[C.map((t,o)=>e.jsx(oe,{position:t.latlng,children:e.jsxs("div",{className:`label text-white w-[20px] h-[20px]
                  flex items-center justify-center rounded-full
                  
                  ${S(s==null?void 0:s.day)}`,children:[e.jsx("span",{className:"center font-medium text-white text-[12px]",children:o+1})," "]})},`${t.title}-${o}`)),e.jsx(re,{path:A,strokeWeight:3,strokeColor:W(s==null?void 0:s.day),strokeOpacity:.7,strokeStyle:"solid"})]})}):null,e.jsxs("div",{className:"flex flex-col gap-[20px] px-[32px]",children:[e.jsxs("div",{className:"flex gap-[10px] items-center",children:[e.jsxs("h3",{className:`font-work-sans text-[24px] font-bold ${_(s.day||g+1)} `,children:["Day ",s.day||g+1]}),e.jsx("span",{className:"text-[18px] text-slate-700",children:j}),e.jsx("div",{className:"w-[30px] h-[30px] flex items-center justify-center text-[30px]",children:G(s==null?void 0:s.weather)})]}),e.jsxs("ul",{className:"relative flex flex-col gap-[30px]",children:[l==null?void 0:l.map((t,o)=>e.jsxs("li",{className:"flex flex-col gap-[30px] justify-center ",children:[t.scheOrMemo==="SCHE"?e.jsxs("div",{className:"flex gap-[30px] items-center cursor-pointer",onClick:()=>K(t),children:[e.jsx("div",{className:`w-[30px] h-[30px]
                                  flex items-center justify-center  
                                  rounded-full
                                  text-[16px] text-white font-medium
                                  ${S(s==null?void 0:s.day)}`,children:o+1}),e.jsxs("div",{className:"flex gap-[20px] items-center",children:[e.jsx("div",{className:"w-[60px] h-[60px] bg-slate-200 rounded-lg overflow-hidden",children:e.jsx("img",{src:`${ee}${t.strfId}/${t.picName}`,alt:"thum",className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-[20px] text-slate-700",children:t.strfTitle}),e.jsxs("div",{className:"flex gap-[10px] items-center",children:[e.jsx("p",{className:"text-[14px] text-slate-500",children:Z(t.category)}),e.jsx("div",{className:"flex gap-[10px] items-center",children:e.jsx("div",{className:"flex gap-[5px] items-center",children:e.jsx(ne,{disabled:!0,count:1,value:t.reviewed?1:0,style:{width:"16px",height:"16px",display:"flex",alignItems:"center",justifyContent:"center"}})})})]})]})]})]}):e.jsxs("div",{className:"flex gap-[30px] items-center",children:[e.jsx("div",{className:"w-[30px] h-[30px] flex items-center justify-center",children:e.jsx("div",{className:`w-[10px] h-[10px] flex items-center justify-center rounded-full  text-[16px] text-white font-medium ${S(s==null?void 0:s.day)}`})}),e.jsxs("div",{className:`flex  gap-[10px] justify-between\r
                  px-[40px] py-[20px] w-full rounded-2xl\r
                  bg-slate-50 `,children:[e.jsxs("div",{className:"flex flex-col gap-[10px]",children:[e.jsxs("p",{className:"flex gap-[5px] text-slate-700",children:[e.jsx(U,{className:"text-slate-300 text-[18px]"}),t.title]}),e.jsx("p",{className:"text-[14px]",children:t.content})]}),e.jsx("button",{type:"button",onClick:()=>B(t),children:e.jsx(te,{className:"text-slate-500"})})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-[30px] h-[30px] flex items-center justify-center",children:e.jsx("div",{className:`w-[10px] h-[10px] flex items-center justify-center rounded-full  text-[16px] text-white font-medium ${S(s==null?void 0:s.day)}`})}),e.jsxs("div",{className:`${t.pathType===null?"h-[38px] flex gap-[10px] items-center px-[10px] bg-slate-50 rounded-2xl cursor-pointer":"h-[38px] flex gap-[10px] items-center px-[10px] bg-white rounded-2xl"}`,onClick:()=>{console.log(t)},children:[e.jsx("div",{className:`${t.pathType===null?"text-slate-600 h-[18px]":"text-slate-400 h-[18px]"}`,children:J(t.pathType)}),e.jsxs("div",{className:`${t.pathType===null?"text-[14px] text-slate-600 h-[18px]":"text-[14px] text-slate-400 h-[18px]"}`,children:[t.duration,t.pathType>0?"분":""]})]})]})]},o)),e.jsx("div",{className:`border-l border-slate-200\r
                                absolute left-[14px] top-1/2 -translate-y-1/2\r
                                h-[90%] -z-10`})]}),x?e.jsxs("div",{className:"flex gap-[20px] items-center",children:[e.jsxs("button",{type:"button",className:`flex items-center justify-center gap-[10px]\r
              py-[10px] rounded-lg\r
              w-full\r
              border border-slate-300\r
              text-slate-700 text-[22px] font-medium`,onClick:D,children:[e.jsx(Q,{className:"text-slate-400 text-[18px]"}),"일정 추가"]}),e.jsxs("button",{type:"button",className:`flex items-center justify-center gap-[10px]\r
              py-[10px] rounded-lg\r
              w-full\r
              border border-slate-300\r
              text-slate-700 text-[22px] font-medium`,onClick:()=>{k(!0)},children:[e.jsx(ae,{className:"text-slate-400 text-[18px]"}),"메모 추가"]})]}):null]}),y?e.jsx(ce,{setMemoModal:k,tripId:m,data:s,getTrip:f,setTripData:w}):null]})};export{Me as M,Ne as S,we as a};
